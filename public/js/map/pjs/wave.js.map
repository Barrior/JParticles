{"version":3,"sources":["pjs/wave.js"],"names":["win","Particleground","Wave","selector","options","util","createCanvas","this","set","extend","configDefault","dots","initAttr","createDot","draw","resize","random","Math","sin","pi2","PI","opacity","color","num","lineWidth","offsetTop","crest","rippleNum","offsetLeft","speed","prototype","version","attrNormalize","attr","val","isArray","i","push","Array","setAttr","randomColor","rippleLength","limitRandom","getAttr","cw","ch","lineNum","step","line","h","j","x","y","self","cxt","clearRect","globalAlpha","forEach","lineDots","save","beginPath","v","lineTo","moveTo","strokeStyle","stroke","restore","requestAnimationFrame","wave","constructor","window"],"mappings":"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","file":"pjs/wave.js","sourcesContent":["//snow.js\r\n+function ( win, Particleground ) {\r\n    'use strict';\r\n\r\n    var util = Particleground.util,\r\n        random = Math.random,\r\n        sin = Math.sin,\r\n        pi2 = Math.PI * 2;\r\n\r\n    function Wave( selector, options ){\r\n        if( !util.createCanvas( selector, this ) ){\r\n            return;\r\n        }\r\n        this.set = util.extend( {}, Wave.configDefault, options );\r\n\r\n        this.dots = [];\r\n        this.initAttr();\r\n        this.createDot();\r\n        this.draw();\r\n        this.resize();\r\n    }\r\n\r\n    Wave.configDefault = {\r\n        //全局透明度\r\n        opacity: 1,\r\n        //线条颜色\r\n        //color: [],\r\n        color: ['rgba(0, 190, 112, .9)', 'rgba(0, 190, 112, .6)', 'rgba(0, 190, 112, .3)'],\r\n        //线条个数\r\n        num: 3,\r\n        //线条宽度\r\n        lineWidth: 1,\r\n        //线条中点到元素顶部的距离，(0, 1]表示容器的倍数，(1, +∞)表示具体数值\r\n        offsetTop: .75,\r\n        //波峰数值，(0, 1]表示容器的倍数，(1, +∞)表示具体数值\r\n        //crest:.3,\r\n        crest: [16, 12, 8],\r\n        //波纹个数，即正弦周期个数\r\n        rippleNum: [2, 2, 2],\r\n        //线段的横向偏移值\r\n        offsetLeft: [.1, 1, 2],\r\n        //运动速度\r\n        //speed: [.1, .1, .1],\r\n        speed: [.07, .07, .07],\r\n        //自适应窗口尺寸变化\r\n        resize: true\r\n    };\r\n\r\n\r\n    Wave.prototype = {\r\n        version: '1.0.0',\r\n        initAttr: function(){\r\n            var set = this.set;\r\n            var num = set.num;\r\n            var isArray = Array.isArray;\r\n\r\n            attrNormalize( 'color' );\r\n            attrNormalize( 'lineWidth' );\r\n            attrNormalize( 'offsetTop' );\r\n\r\n            function attrNormalize( attr ){\r\n                var val = set[ attr ];\r\n                if( !isArray( val ) ){\r\n                    set[ attr ] = [];\r\n                    if( typeof val === 'number' ){\r\n                        for( var i = 0; i < num; i++ ){\r\n                            set[ attr ].push( val );\r\n                        }\r\n                    }\r\n                }\r\n                //是一个数组可能只写了一个参数\r\n            }\r\n        },\r\n        setAttr: function( attr ){\r\n            switch ( attr ){\r\n                case 'color':\r\n                    attr = util.randomColor();\r\n                    break;\r\n                case 'lineWidth':\r\n                    attr = 1;\r\n                    break;\r\n                case 'offsetLeft':\r\n                    attr = random() * this.rippleLength[i];\r\n                    break;\r\n                case 'speed':\r\n                    attr = util.limitRandom(.4, .2);\r\n                    break;\r\n            }\r\n            return attr;\r\n        },\r\n        getAttr: function( attr, i ){\r\n            var set = this.set;\r\n            var val = set[attr][i];\r\n            if( typeof val === 'undefined' ){\r\n                switch ( attr ){\r\n                    case 'color':\r\n                        val = util.randomColor();\r\n                        break;\r\n                    case 'lineWidth':\r\n                        val = 1;\r\n                        break;\r\n                    case 'offsetLeft':\r\n                        val = random() * this.rippleLength[i];\r\n                        break;\r\n                    case 'speed':\r\n                        val = util.limitRandom(.4, .2);\r\n                        break;\r\n                }\r\n                set[attr].push( val );\r\n            }\r\n            return val;\r\n        },\r\n        createDot: function(){\r\n            var set = this.set,\r\n                cw = this.cw,\r\n                ch = this.ch,\r\n                lineNum = set.num,\r\n                dots = [];\r\n\r\n            this.rippleLength = [];\r\n\r\n            for( var i = 0; i < lineNum; i++ ){\r\n\r\n                //每个周期(2π)在canvas上的实际长度\r\n                var rippleLength = cw / set.rippleNum[i];\r\n                //一个点的高度\r\n                var step = pi2 / rippleLength;\r\n\r\n                this.rippleLength.push( rippleLength );\r\n\r\n\r\n                var\tline = [];\r\n                var h = set.offsetTop;\r\n                if( h > 0 && h <= 1 ){\r\n                    //10 * i不够随机\r\n                    h = h * ch;\r\n                }\r\n\r\n                //创建一条线段所需的点\r\n                for( var j = 0; j < cw; j++ ){\r\n                    line.push({\r\n                        x: j,\r\n                        y: j * step,\r\n                        h: h\r\n                    });\r\n                }\r\n\r\n                dots.push( line );\r\n\r\n            }\r\n            this.dots = dots;\r\n        },\r\n        draw: function(){\r\n            var self = this,\r\n                set = this.set,\r\n                speed = set.speed,\r\n                cxt = this.cxt,\r\n                cw = this.cw,\r\n                ch = this.ch;\r\n\r\n            cxt.clearRect( 0, 0, cw, ch );\r\n            cxt.globalAlpha = set.opacity;\r\n\r\n            this.dots.forEach(function( lineDots, i ){\r\n                cxt.save();\r\n                cxt.beginPath();\r\n                var crest = set.crest;\r\n                if( crest > 0 && crest <= 1 ){\r\n                    crest = crest * ch;\r\n                }\r\n\r\n                lineDots.forEach(function( v, j ){\r\n                    if( j ){\r\n                        //y = A sin（ ωx + φ ）+ h\r\n                        cxt.lineTo( v.x,\r\n                self.getAttr( 'crest', i ) * sin( v.y + self.getAttr( 'offsetLeft', i ) ) + v.h\r\n                        );\r\n                    }else{\r\n                        cxt.moveTo( v.x,\r\n                self.getAttr( 'crest', i ) * sin( v.y + self.getAttr( 'offsetLeft', i ) ) + v.h\r\n                        );\r\n                    }\r\n                    //v.y = v.y - .1;\r\n                    v.y -= self.getAttr( 'speed', i );\r\n                });\r\n                /*cxt.moveTo( cw, ch );\r\n                cxt.moveTo( 0, ch );*/\r\n                //cxt.fill = 'red';\r\n                cxt.strokeStyle = self.getAttr( 'color', i );\r\n\r\n                cxt.lineWidth = self.getAttr( 'lineWidth', i );\r\n                cxt.stroke();\r\n                //cxt.closePath();\r\n                cxt.restore();\r\n            });\r\n\r\n            this.requestAnimationFrame();\r\n        }\r\n    };\r\n\r\n    //继承公共方法，如pause，open\r\n    Particleground.extend( Wave.prototype );\r\n    //添加实例\r\n    Particleground.wave = Wave.prototype.constructor = Wave;\r\n}( window, Particleground );"],"sourceRoot":"/source/"}